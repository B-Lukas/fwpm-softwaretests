image: maven:latest

stages:
  - maven-build
  - maven-test
  - docker-build

maven-build:
  stage: maven-build
  script:
    - 'mvn clean install -DskipTests'

maven-test:
  stage: maven-test
  script:
    - 'mvn test'

docker-build:
  stage: docker-build
  script:
    - './mvn clean package -DskipTests=true dockerfile:build '
  only:
    - master
